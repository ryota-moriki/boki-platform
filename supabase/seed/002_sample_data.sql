-- サンプル章データの挿入
INSERT INTO public.chapters (title, description, order_index, is_published) VALUES
('第1章: 簿記の基礎', '簿記とは何か、なぜ必要なのかを学びます', 1, true),
('第2章: 仕訳の基本', '取引を記録する仕訳の基本ルールを学びます', 2, true),
('第3章: 勘定科目', '資産・負債・純資産・収益・費用の勘定科目を学びます', 3, true),
('第4章: 商品売買', '商品の仕入れと売上の処理を学びます', 4, true),
('第5章: 現金・預金', '現金と預金の取引処理を学びます', 5, true),
('第6章: 手形取引', '約束手形と為替手形の処理を学びます', 6, false),
('第7章: 有形固定資産', '建物や備品などの固定資産の処理を学びます', 7, false),
('第8章: 決算整理', '決算時の整理仕訳を学びます', 8, false),
('第9章: 精算表', '精算表の作成方法を学びます', 9, false),
('第10章: 財務諸表', '貸借対照表と損益計算書の作成を学びます', 10, false);

-- 第1章のスライドデータ
WITH chapter1 AS (
  SELECT id FROM public.chapters WHERE title = '第1章: 簿記の基礎'
)
INSERT INTO public.slides (chapter_id, title, content, order_index)
SELECT 
  chapter1.id,
  slide.title,
  slide.content,
  slide.order_index
FROM chapter1,
(VALUES
  ('簿記とは', '簿記（ぼき）とは、企業や個人事業主の経済活動を記録・計算・整理する技術です。

日々の取引を体系的に記録し、財政状態や経営成績を明らかにすることが目的です。

簿記を学ぶことで、お金の流れを正確に把握し、適切な経営判断ができるようになります。', 1),
  
  ('簿記の必要性', '## なぜ簿記が必要なのか？

1. **法的義務** - 税務申告のため正確な記録が必要
2. **経営管理** - 利益や資産の状況を把握
3. **信用獲得** - 銀行融資や取引先との信頼関係
4. **意思決定** - データに基づいた経営判断

簿記は「ビジネスの共通言語」とも呼ばれています。', 2),
  
  ('簿記の種類', '## 簿記には2つの種類があります

### 単式簿記
- 家計簿のような簡単な記録方法
- 収入と支出のみを記録
- 個人事業主の簡易的な記録に使用

### 複式簿記
- 取引を2つの側面から記録
- 貸借が一致する仕組み
- 企業会計で使用される標準的な方法

日商簿記検定では**複式簿記**を学習します。', 3),
  
  ('貸借一致の原則', '## 複式簿記の基本原則

複式簿記では、すべての取引を**借方（かりかた）**と**貸方（かしかた）**の2つの側面から記録します。

### 重要なルール
**借方の合計 = 貸方の合計**

この原則により：
- 記録の正確性が保証される
- 間違いを発見しやすい
- 財政状態を正確に把握できる', 4),
  
  ('5つの要素', '## 簿記の5要素

すべての取引は以下の5つの要素に分類されます：

1. **資産** - 会社が所有する財産（現金、建物、商品など）
2. **負債** - 会社が支払う義務（借入金、買掛金など）
3. **純資産** - 資産から負債を引いた差額（資本金など）
4. **収益** - 会社の収入（売上など）
5. **費用** - 会社の支出（給料、家賃など）

これらの要素を使って取引を記録していきます。', 5)
) AS slide(title, content, order_index);

-- 第2章のスライドデータ
WITH chapter2 AS (
  SELECT id FROM public.chapters WHERE title = '第2章: 仕訳の基本'
)
INSERT INTO public.slides (chapter_id, title, content, order_index)
SELECT 
  chapter2.id,
  slide.title,
  slide.content,
  slide.order_index
FROM chapter2,
(VALUES
  ('仕訳とは', '## 仕訳（しわけ）の基本

仕訳とは、取引を借方と貸方に分けて記録することです。

### 仕訳の形式
```
(借方) 勘定科目 金額 | (貸方) 勘定科目 金額
```

### 例：現金100円を受け取った
```
(借方) 現金 100 | (貸方) 売上 100
```

左側が借方、右側が貸方です。', 1),
  
  ('借方と貸方の覚え方', '## 借方（かりかた）・貸方（かしかた）

### 位置を覚える
- **借方** = **左側**
- **貸方** = **右側**

### 覚え方のコツ
「**か**り方」の「**り**」には、「**ひだり**」の「**り**」が入っている
→ 借方は左側！

貸方は残った右側！

この位置関係は絶対に変わりません。', 2),
  
  ('増減のルール', '## 勘定科目の増減ルール

### 借方に記入すると増加するもの
- **資産**の増加
- **費用**の発生

### 貸方に記入すると増加するもの
- **負債**の増加
- **純資産**の増加
- **収益**の発生

### 覚え方
「資産と費用は借方で増える」
「負債・純資産・収益は貸方で増える」', 3),
  
  ('仕訳の手順', '## 仕訳を行う4つのステップ

1. **取引の把握** - 何が起きたかを理解する
2. **勘定科目の決定** - 使用する科目を選ぶ
3. **借方・貸方の判断** - どちらに記入するか決める
4. **金額の記入** - 取引金額を記入する

### 例：商品1,000円を現金で販売
1. 商品を売って現金を受け取った
2. 「現金」と「売上」を使用
3. 現金（資産）増加→借方、売上（収益）発生→貸方
4. 両方とも1,000円', 4),
  
  ('仕訳の実例', '## よくある仕訳の例

### 1. 現金で商品を仕入れた（500円）
```
(借方) 仕入 500 | (貸方) 現金 500
```

### 2. 商品を掛けで販売した（800円）
```
(借方) 売掛金 800 | (貸方) 売上 800
```

### 3. 給料を現金で支払った（3,000円）
```
(借方) 給料 3,000 | (貸方) 現金 3,000
```

必ず借方と貸方の金額は一致します！', 5)
) AS slide(title, content, order_index);

-- 第1章の練習問題
WITH chapter1 AS (
  SELECT id FROM public.chapters WHERE title = '第1章: 簿記の基礎'
),
slide1 AS (
  SELECT id FROM public.slides WHERE chapter_id = (SELECT id FROM chapter1) AND order_index = 3
)
INSERT INTO public.questions (chapter_id, slide_id, question_type, question_text, options, correct_answer, explanation, order_index)
SELECT 
  chapter1.id,
  slide1.id,
  'slide_practice',
  '日商簿記検定で学習する簿記の種類はどれですか？',
  '[{"id": "a", "text": "単式簿記"}, {"id": "b", "text": "複式簿記"}, {"id": "c", "text": "三式簿記"}, {"id": "d", "text": "簡易簿記"}]'::jsonb,
  'b',
  '日商簿記検定では複式簿記を学習します。複式簿記は取引を借方と貸方の2つの側面から記録する方法で、企業会計の標準的な記録方法です。',
  1
FROM chapter1, slide1;

-- 第1章の確認テスト問題
WITH chapter1 AS (
  SELECT id FROM public.chapters WHERE title = '第1章: 簿記の基礎'
)
INSERT INTO public.questions (chapter_id, slide_id, question_type, question_text, options, correct_answer, explanation, order_index)
SELECT 
  chapter1.id,
  NULL,
  'chapter_test',
  q.question_text,
  q.options,
  q.correct_answer,
  q.explanation,
  q.order_index
FROM chapter1,
(VALUES
  ('簿記の5要素に含まれないものはどれですか？',
   '[{"id": "a", "text": "資産"}, {"id": "b", "text": "負債"}, {"id": "c", "text": "利益"}, {"id": "d", "text": "費用"}]'::jsonb,
   'c',
   '簿記の5要素は、資産・負債・純資産・収益・費用です。利益は収益から費用を引いた結果であり、5要素には含まれません。',
   1),
  
  ('複式簿記の特徴として正しいものはどれですか？',
   '[{"id": "a", "text": "収入のみを記録する"}, {"id": "b", "text": "支出のみを記録する"}, {"id": "c", "text": "取引を2つの側面から記録する"}, {"id": "d", "text": "現金の動きのみを記録する"}]'::jsonb,
   'c',
   '複式簿記は、すべての取引を借方と貸方の2つの側面から記録します。これにより貸借一致の原則が保たれます。',
   2),
  
  ('貸借一致の原則とは何ですか？',
   '[{"id": "a", "text": "借方の合計と貸方の合計が一致する"}, {"id": "b", "text": "資産と負債が一致する"}, {"id": "c", "text": "収益と費用が一致する"}, {"id": "d", "text": "現金と預金が一致する"}]'::jsonb,
   'a',
   '貸借一致の原則は、借方の合計額と貸方の合計額が必ず一致するという複式簿記の基本原則です。',
   3)
) AS q(question_text, options, correct_answer, explanation, order_index);